<html>
<head>
  <script src='jquery.min.js'></script>
  <script src='jsmaze.js'></script>
  <title>jsMaze</title>
</head>
<body>
  <center>
    <h2>jsMaze</h2>
    <table>
      <tr>
        <td>
          <table>
            <tr>
              <td colspan='2' align='center'>
                <input type='submit' value='For ^ ward' onClick='goForward()'/>
                <br/><br/>
              </td>
            </tr>
            <tr>
              <td align='center'>
                <input type='submit' value='< Turn' onClick='turnLeft()'/>
                <input type='submit' value='Turn >' onClick='turnRight()'/>
              </td>
            </tr>
            <tr>
              <td colspan='2' align='center'>
                <br/>
                <input type='submit' value='Ba v ck' onClick='goBack()'/>
              </td>
            </tr>
          </table>
        </td>
        <td>
          <canvas id='draw' width='768' height='768'></canvas>
        </td>
        <td>
          <table>
            <tr>
              <td colspan='2' align='center'>
                <input type='submit' value='For ^ ward' onClick='goForward()'/>
                <br/><br/>
              </td>
            </tr>
            <tr>
              <td align='center'>
                <input type='submit' value='< Turn' onClick='turnLeft()'/>
                <input type='submit' value='Turn >' onClick='turnRight()'/>
              </td>
            </tr>
            <tr>
              <td colspan='2' align='center'>
                <br/>
                <input type='submit' value='Ba v ck' onClick='goBack()'/>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>
          <center>
            <canvas id='topview' width='500' height='500'></canvas>
          </center>
        </td>
      </tr>
    </table>
    <p>
  </center>
  <script>

function draw() {
    maze.draw3d(canvas3d, pos, dir);
}

function maybeUpdate(i, j) {
    if (i>=0 && i<maze.width && j>=0 && j<maze.height) {
        pos.i = i;
        pos.j = j;
        draw();
    }
}

function goForward() {
    var i = pos.i;
    var j = pos.j;
    if (dir.i ?
        !maze.vert[j][(dir.i>0) ? i+1 : i] :
        !maze.horiz[(dir.j>0) ? j+1 : j][i]) {
        maybeUpdate(i + dir.i, j + dir.j);
    }
}
function goBack() {
    var i = pos.i;
    var j = pos.j;
    if (dir.i ?
        !maze.vert[j][(dir.i>0) ? i : i+1] :
        !maze.horiz[(dir.j>0) ? j : j+1][i]) {
        maybeUpdate(i - dir.i, j - dir.j);
    }
}
function turnRight() {
    di = dir.i;
    dir.i = -dir.j;
    dir.j = di;
    draw();
}
function turnLeft() {
    di = dir.i;
    dir.i = dir.j;
    dir.j = -di;
    draw();

}


// Alternating horizontal and vertical wals
map = ["----------",
       "||      | |",
       "  ------- ",
       "| |    | ||",
       "   -----  ",
       "|| |  | |||",
       "    ---   ",
       "||| |  ||||",
       "     -    ",
       "||||  | |||",
       "    --    ",
       "||||   | ||",
       "   ----   ",
       "||| |   | |",
       "  ------  ",
       "|| |     ||",
       " -------- ",
       "| |       |",
       "----------"]

var maze = new Maze(map);
var canvas = $('#topview')[0];
maze.edit(canvas);

var canvas3d = $('#draw')[0];
var pos = {i:0, j:0};
var dir = Maze.DOWN;
maze.draw3d(canvas3d, pos, dir);

  </script>
</body>
</html>
